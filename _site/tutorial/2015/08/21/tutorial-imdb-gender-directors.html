<!DOCTYPE html>
<html>

<head>
    <title>Using IMDB to quantify the gender gap among film directors</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="This post is a recap/tutorial of a Silk Webinar on data collection and cleansing movie data from the Internet Movie Database.">
    <link rel="stylesheet" href="/assets/css/main.css ">
    <link rel="canonical" href="/tutorial/2015/08/21/tutorial-imdb-gender-directors.html">
</head>


<body>
    <!-- Wrapper -->
<div id="wrapper">

	<header id="header">
		<div class="inner">

			<!-- Logo -->
			<a href="/" class="logo">
				<span class="symbol">

					

					<div href="#" class="icon style1 "></div>

					
				</span><span class="logo"><img src="/images/logo.png" alt="" style="max-width: 40%; max-height: 40%"/></span>
			</a>
			<!-- Nav -->
			<nav>
				<ul>
					<li><a href="/bio">Bio</a></li>
					<li><a href="/portfolio">Portfolio</a></li>
					<li><a href="/events">Events</a></li>
					<li><a href="/tutorials">Tutorials</a></li>
				</ul>
			</nav>

		</div>
	</header>

	<!-- Main -->
	<div id="main">
		<div class="inner">

      <hr>
<article itemscope itemtype="http://schema.org/BlogPosting" style="width:80%; margin:0px auto; text-align: justify;"">
    <h2 style="color:#FF6B6B;" itemprop="name headline">Using IMDB to quantify the gender gap among film directors</h2>
    <p>
      <time datetime="2015-08-21T18:24:44+02:00" itemprop="datePublished">
        <em>Aug 21, 2015</em>
      </time>
      
        • <span>tutorial</span>
      
    </p>
  <div itemprop="articleBody"><p>This post is a recap/tutorial of a Silk Webinar on data collection and cleansing movie data from the Internet Movie Database.<br />
<!--more--><br />
In this post we’ll offer a step-by-step tutorial of how to:</p>

<ul>
  <li>Use APIs to add movie information (such as plot, producing country and poster image)</li>
  <li>Use some Google Sheet advanced functions</li>
  <li>Handle JSON data with Open Refine and convert it to a spreadsheet</li>
  <li>Get you data clean through clustering and regex</li>
  <li>Automatically guess the gender of a name thanks to APIs</li>
</ul>

<p>Since we went through a lot of very cool stuff on data cleaning and enhancing yesterday, I wrote out the steps I took, which you can view below. Also, be sure to bookmark <a href="http://silk-webinars.silk.co">silk-webinars.silk.co</a>, as we update that with information on all our webinars (including links, information on tools used, etc.)</p>

<iframe src="https://www.youtube.com/embed/zA-Aae_oZYk?feature=oembed" allowfullscreen="allowfullscreen" height="405" frameborder="0" width="720"></iframe>
<p>The webinar focused on cleaning and enhancing data. We find that data almost never comes in perfect form. Cleaning the data for consistency and accuracy is required before turning that data into a real story. Here’s a written walkthrough.</p>

<h2>Start with a spreadsheet of movies containing IMDb IDs for each movie </h2>

<p>For this exercise, you need to have a dataset containing a list of movies and their relative IMDb IDs. What is an IMDbId? It’s essentially the “tt1234567” that you see in the URL of a movie’s profile on IMDb.</p>

<image src="https://draftin.com:443/images/31781?token=WR4c-8NHGaJg2949QCyO4sU4P5rXu4uIlQTDrUnWjhiKwR9GWDtILo-f4DJY7pfygFH_QamNuHr5wuo3PBIc7j4" style="max-width: 80%;">     
<br />
IMDb lets you export any list on the site as a .CSV (if you are logged in as a user). So the easiest way to kickstart your dataset is simply to pick any interesting pre-made list: <a href="http://www.imdb.com/list/ls074674014/">Sundance 2015</a>,<a href="http://www.imdb.com/list/ls074674014/"> Greatest Movies of All Times</a>, your own <a href="http://www.imdb.com/list/watchlist?"> IMDb watchlist</a>, etc…  
<br />

<image src="https://draftin.com:443/images/31785?token=OvoxTa8zzBU3HbrFA5YET4dB_YzxvECBbA-1aPtosDqPFddUiLWmX23r-Ewu31lhK8jtw3JdydOdvNoUdUgEdbE" style="max-width: 80%;">   
<br />
<em>This is what you see at the bottom of an IMDb list if you are logged in</em>.   
<br /> 
If the list you want is not there, you can always start with your own custom movie list and add the movie IDs manually.  
<br />
<br />

<h2>Enrich the data with APIs! Add plot, actors, producing country, movie poster, and more </h2>  

<h3>1. Understanding APIs</h3>

To add extra information about each movie, we are going to use the <a href="http://www.omdbapi.com">Open Movie Database APIs</a> (OMDB). An API call to OMDB is made using the IMDb ID, and returns information about the movie with that ID, in a JSON format. The IMDb URL for Mr.Nobody is: <a href="http://www.imdb.com/title/tt0485947">http://www.imdb.com/title/tt0485947</a> So the IMDb ID is tt0485947, and the OMDB API call would look like this (where the IMDb id goes after the <code>i=</code>): <a href="http://www.omdbapi.com/?i=tt0485947&amp;plot=full&amp;r=json">http://www.omdbapi.com/?i=tt0485947&amp;plot=full&amp;r=json</a>. Type the previous URL in your browser, and it will show information about the movie in a JSON Format.   
<br />

<image src="https://draftin.com:443/images/31789?token=wITWaugY0DL1S2N5ec3V-p46nnVDpli5FqChLta4f5EmjtATfzo21ebNrgsYd_Kw1o-STZgY9dUIt3R4I0DRC4A" style="max-width: 80%;">  

<h3>2. Add the extra data to your original dataset, in bulk</h3>

We are now going to get the JSON data for **all** the movies in your list and add it to your dataset directly. This will take just a few minutes, even if your list has 1,000 movies. Import your .CSV in a Google Sheet spreadsheet. You can delete any extra columns you are not interested in, **but remember you need to keep the one with the IMDb IDs for each movie**. Move the column with the IMDb ID to the end of your spreadsheet. In my case, this is column E. Go in the first row of your spreadsheet, and to the first empty cell on the right. (It should have the IMDb ID in the cell on its left). In my case, this is cell F2. In this cell, type the following formula <code>="http://www.omdbapi.com/?i="&amp;E2&amp;"&amp;plot=full&amp;r=json"</code> Then, drag it down for the whole column. This should fill in the cells in this column with the correct OMDB API URL specific to each movie.   
<br />
<image src="https://draftin.com:443/images/31793?token=ml4U21rgmGmkWCevhh78y4PL0Tb4kxMlPX1BdDspsJ-hcjV68l7CO8FGN2BiCRiabNHmqMhspNwj1L-SoO1Iqxw" style="max-width: 80%;">   
<br />
To see if it worked, click through some of these links. Each should lead you to the JSON data for the movie contained in that row. Now we are going to actually get that JSON data inside your Google Sheet. To do this, go to the first row of your spreadsheet and to the first empty cell on the right, which is next to the cell containing the OMDB URL. In my case, this is cell G2. In this cell type this formula: <code>=CONCATENATE(IMPORTDATA(F2))</code> Again, drag this formula down through all the cells in the column. You will now have the JSON Data all together in this column. Don’t worry if it looks cluttered and messy, we’re going to clean it up soon!    
<br />

<image src="https://draftin.com:443/images/31795?token=ONqafL6j9Jroi_unsVxgQ39DqUovqaKZNl7VLbsiIqEy3w5-O0Oh_d9OkJeCf7NXZASoh-2-ey80ScH_ja7p4sU" style="max-width: 80%;">   
<br />
<br />

<h2>Polish your data with Open Refine</h2>

We are now going to use <a href="http://openrefine.org">Open Refine</a> to get the data clean, especially to get the information we want out of that JSON data we just added to the spreadsheet. Export your Google Sheet as a .CSV file. Launch Open Refine and create a new project. Import your .CSV file, making sure you select the proper character encoding (UTF-8).    
<br />

<image src="https://draftin.com:443/images/31796?token=xcBgeE9vQxesPKSWv71b3vCmUsSWjJHmx3EnOltGWVvQhqpJZ0FFLi9C8g47jyvjALTbn6F6-B4BLNFIH6-RzYs" style="max-width: 80%;">   
<br />
Now, click on <code>Create Project</code> in the upper right corner.  

<h3>1. Cleaning up the cells with the JSON data</h3>

<b>a. Splitting different data into different columns</b>   
<br />
First, we want to split all this text into some different cells. If you look at the structure of the text, you’ll notice that a <code>":"</code> separates the different bits of data (Year, Rating, Plot). So click on the arrow you see in the column header and do this flow: <code>Edit Column-&gt; Split into Several Columns...</code>  
<br />

<image src="https://draftin.com:443/images/31797?token=Q4XidvORNBzYEbCKV9A-8hBWT8mPmbOetXPXYr5jV6D4j7iuggwX5tIEIFhcUEuLqomQiYLG2QWa37rIAPWhgR4" style="max-width: 80%;">    
<br />
A dialog box will appear, asking you to type in the separator by which to separate the columns. Type <code>":"</code> and then this will be the result.     
<br />
<image src="https://draftin.com:443/images/31798?token=hN2BKQhFqopogTvlhQo92znIWMP6Biu6HcCFQZ_XYB4z-JzO-ds41NsflSfcD1m4KQ5cVmmA5UHqbWcjtIzrnQQ" style="max-width: 80%;">    
<br />
Now we can delete columns we don’t need. For example, we can get rid of the column that contains <code>{"Title</code>, or the ones with information we already had (Title, Year..). As you might have notice, the information about what type of data is in a cell, is contained at the end of the cell at its left. We are going to fix this in the next steps.  
<br />

<image src="https://draftin.com:443/images/31801?token=rktpkD76VO3Kw7czA6xe5ZwfibXH9YXbLKigNvU_9V0TO-jq4AWpslHCu5oBknwVjuv2GTwauFco9eyLsyt5Q1E" style="max-width: 80%;">    
<br />

<b>b. Cleaning up the text resulted from the OMDB API</b>   
<br />
In my case, the first column I want to keep is the one with the Writers. As this column is followed by the one with Actors, it has a “Actors” attached at the end of it. To get rid of this, go to the drop-down menu in the header of the Writer’s column, click <code>Edit Cells -&gt; Transform...</code> We are going to use <a href="https://github.com/OpenRefine/OpenRefine/wiki/GREL-String-Functions">Google Refine Expression Language</a> (GREL) and <a href="https://en.wikipedia.org/wiki/Regular_expression">regular expressions</a> to come up with a formula that will remove the string “Actor” from the end of all the cells in this column. The formula you can type in the dialog box is: <code>replace(value,/Actors$/,"")</code>This formula is taking the content of each cell in the column (value), looking for the string *Actors* when it’s at the end of the line (that’s why the <code>$</code> is there) and delete it (literally replace it with an empty string). <em>Extra: This formula is using a regular expression, because of the <code>$</code>. That’s why the <code>/</code> wraps the text we want to replace. This is an extra precaution, to avoid deleting potential cases where the word ‘Actors’ might possibly have been a name of a writer, and thus not have been the last word in the cell that we wanted to get rid of. If you just want to replace a string without using regular expressions, then you can omit the slashes and the dollar sign from the formula</em>.   
<br />

<image src="https://draftin.com:443/images/31802?token=X-UWXxOgMEdpkuZ8kfYcVhyddVWjrEZdNcN01sR557WvYDP9tk0sBSNwQXOEGxdhY2B0RDsYjcotXbcVN5jReeg" style="max-width: 80%;">   
<br />
You should repeat this step for the next column, typing in the same <code>replace</code> formula as before, only changing the text to replace (Actors) with the proper one for each column. For example, the column with the Actors has “Plot” at the end, the column with Plot has “Language” at the end, the column with the URL of the image has “Metascore” at the end, and so on. It might be useful to rename the columns to identify the data they contain, so as not to mix them up once you have removed this information from the cells. An additional cleaning step you can take is to remove the stuff in brackets that is in the column Writers.   
<br />
<image src="https://draftin.com:443/images/31803?token=HBNP1WAP00WvHq1QScQxcNG7RdCfvRHRKwXTRxBW02Q8I1UiI7vVWX1V5O3880VgSZld8r691nW9MVKdvmcFfos" style="max-width: 80%;">    
<br />
To do this, you again go to <code>Edit Cells-&gt;Transform...</code> Here, the formula you need to write is this one <code>replace(value,/\(.+\)/,"")</code> At the end of this process, your JSON data is clean, and we can move on to a few more useful data cleaning hacks!   

<h3> 2. Is Woody Allen the same as Allen, Woody? Get your data clean for a machine.</h3>

If you ask a person, Woody Allen is the same as Allen, Woody. And probably, a person would guess that Woody Alen is also the same guy, likely spelled wrong because of an oversight. Problem is, for a computer or a data analysis software each of these strings is spelled differently and thus counts as a different entity. In many cases, even an extra space at the end of a name is enough to make a computer think that “Woody Allen” is another person than “Woody Allen ”! So, before you analyze and visualize your data correctly, and jump to conclusions, you need to make sure you each different entity has one (and only one) name. Luckily, Open Refine has algorithms in place that will help you find suspicious cases where your data doesn’t look so clean. Here’s how to use them. I’m going to use it on the Director column, but you can apply the same steps for Writers, Country, Actors… Go to the drop-down menu for the column Directors and click through <code>Facet-&gt; Text Facet</code> On the left, you will see a list of all the instances that appear in the cells of the column Directors. As you can see, some cells contain more than one director, comma-separated. To clean up this data however, we want a single director in each cell. To do this, go again in the drop-down menu for the column Directors and click to <code>Edit Cells-&gt; Split multi-valued cells...</code> Then pick the comma as a separator. Now, if you look again at the box on the far left, you will have a single director in each row. Click on the <code>Cluster</code> button in this box. This will open a dialog box that will use different algorithms to try identify multiple spellings of the same entity and to cluster them into one.   
<br />
<image src="https://draftin.com:443/images/31804?token=yRofHvE-qoFyKnUJTDlMe86F2SoUvJpIpJGzGOzY2b7mPc6yPFa-d-I015MPzTgtaYP0lX-1DCBmqtKKHuLQg00" style="max-width: 80%;">    
<br />
Select the one that you think refer to the same person, then click <code>Merge Selected &amp; Recluster</code> to unite the multiple instances into a same spelling. At the top, you can change through different methods and clustering functions. For example, the above result was generated with the <em>key collision</em> method and the <em>fingerprint</em> function. For optimal results, I suggest you try to apply all the methods and functions to your dataset and only stop merging and reclustering when you don’t find any more appropriate suggestions. Of course, if you have doubts about whether two different spellings refer to the same person, first do some research before merging! When you’re done with this, you need to join back the cells in the Director column - we had split them to facilitate merging same entities spelled differently, but now we do want that each movie has a comma-separated list of its directors in the Director column. So go to the drop-down menu for the column Directors and click to <code>Edit Cells-&gt; Join multi-valued cells...</code> Then pick the comma as a separator. Now your data is ready for export! You can export your project from Open Refine and import it back to the Google Sheet you were using. Your movie list should now be ready for any project you wish to carry out: showcase your favorite movies, correlate plot keywords and IMDb ratings, analyze how colors in a movie poster change depending on the genre, and whatever else strikes your fantasy. In the next paragraph we’ll go over another trick, in case you wish to enhance your data further: how to determine the gender of the directors of the movies in your dataset.   
<br />
<br />

<h2>Carry out gender analysis with the help of APIs</h2>

<b>Make sure you have exported and saved your cleaned data in a file already</b>   
<br />
<br />

<h3>1. Create a dataset which links every single director to a movie (s)he directed</h3>

Go back to the Open Refine tab with your project. Start deleting all columns except the one with the directors and the one with the IMDb id. Then, move the latter to the beginning of the sheet. Click on the drop-down menu of the Director column, then <code>Edit Cells-&gt; Split multi-valued cells...</code> and choose the comma as a separator. You will now have a single director in each cell. Problem is, for some of them there is now no information about the movie they directed (see white spaces in the first column). Before splitting:   
<br />
<image src="https://draftin.com:443/images/31805?token=8fK4Owp9GLzWGFucDVNHIuq-AWeB_i8ggKi8XEiTQved4VkcJFOCcNukM4EuEWyMU3Ii3S6stFode0xlu_xn-9I" style="max-width: 80%;">    
<br />
After splitting:    
<br />
<image src="https://draftin.com:443/images/31806?token=h3bB6bNZJA64zMJ8q1kKc48N904ynfV4dTP4ulvsbVr96rmuHSeVo67xDtGGrKhnPM4ao_VDMdSBk2KmLi8jkYw" style="max-width: 80%;">   
<br />

This can be easily solved by filling the empty cells with the value of the previous cell. To do so, click on the drop-down menu of the column with the IMDb IDs, then <code>Edit Cells-&gt; Fill down</code>. We now want to be able to guess the gender of the directors. Generally, this can be done by looking at their first names. So we need to create a column with only the first names. Go to menu of the Director column, then to <code>Edit column-&gt; Add a column based on this column...</code> In the pop-up that follows, fill in the column name (First Name) and the following formula <code>value.split(" ")[0]</code> The formula essentially is telling Open Refine to split the values contained in the cells of the Director column on every space, and then write the first piece of text that results from the split into the new column.         <br />
<image src="https://draftin.com:443/images/31807?token=bFWNHwTjWsW2zjyyPxW4ALB8suDv-hMDduNnvDezA__jg7170UfQJgp0zrlD9VmRYbC_vhzd85qDsLV1cKqmg6o" style="max-width: 80%;">    
<br />
We can now export the project as a .CSV and import in the a new sheet of the Google spreadsheet we were working on. (Make sure you aren’t overwriting the cleaned sheet with all the movies!)  

<h3>2. Determine whether a first name (likely) belongs to a man or a woman</h3>

You can manually go through your list of names to assign a gender to each one. Or you can quickly ask for the help of an API to do the work for you. Here we’ll go over how to use the <a href="https://store.genderize.io">Genderize.io API</a>. Like with the OMDB API, we have to construct an API call (URL) for each name. For example, if we want to know the gender of “Peter”, we’d need this URL <a href="https://api.genderize.io/?name=peter"> <code>https://api.genderize.io/?name=peter</code></a>. If you type this URL in your browser, you get this: <code>{"name":"peter","gender":"male","probability":"1.00","count":4373}</code> The result of this call basically tells us that <em>Peter</em> is a male name, with a probability of 100% according to their dataset of 4,373 people called Peter. To make this work for our dataset, we need to build one of these URLs for each of the directors in the latest sheet we just created. To do this, go to the first row of the Director sheet and to the first empty cell you find. In my case, it’s D2. And in the previous column C2 I have the first names of the directors. In cell D2, type the following formula <code>="https://api.genderize.io/?name="&amp;lower(C2)</code> Then, drag it down for the whole column.  
<br />
<image src="https://draftin.com:443/images/31808?token=LxNtdX_nExskby5Fir_gym-1hRzZRB7plX0-D4OIHAVjSkRljTkbN9GwCXuZYpBSZTql1Cv3EJ6tLMdAqFNM3_4" style="max-width: 80%;">   
<br />
Now, go to the next column and in the first cell type <code>=IMPORTDATA(D2)</code> Again, drag it down till the end of the column. You will now have information about the gender of all the directors in your dataset!  
<br />
<image src="https://draftin.com:443/images/31809?token=cQtKG1TPx-smCxjLZGU0QU-mq0X798k-2iml5f3Ajny4YTG1JL-UeCvzn1RX2I6fhdDrI91PKZTMk1WJmEGYPE0" style="max-width: 80%;">   
<br />
You can delete the other two columns, and keep only the one with the Male / Female information. <em>Note: Make sure you’ve first selected the column with the gender and clicked through <code>Edit-&gt;Copy</code> and then <code>Edit-&gt;Paste Special-&gt;Paste Values only</code></em>. Of course, if you want to be accurate, check the cases where the gender assigned had lower confidence probabilities. And manually research ambiguous cases. You might also want to do someresearch on the names that gave a <code>null</code> output and fill in the proper gender information. Now, we need to delete the <code>gender":"</code> text that is before the male/female information. Just select this whole column and go to <code>Edit-&gt;Find and Replace...</code>. Now type <code>gender":"</code> in the <code>Find</code> block, and leave the <code>Replace</code> empty. Click <code>Replace all</code> and you’re done.    
<br />
<br />

<h2> What next?</h2>

Now you have two sheets, one with movies and one with directors. These two sheets can be linked through the common column with the IMDb ID’s that both have. This means now you can do all sort of director’s gender analysis on the movies in your dataset. For example see the male-to-female ratios:  
<ul>
<li>of movie directors of different genres</li>
<li>for different plot keywords</li>
<li>for high/low IMDb ratings</li>
</ul> and so on! For inspirations, here are some projects I created using a similar workflow   
<br />
<ul>
<li><a href="http://oscars.silk.co/page/Gender%20Gap%20at%20the%20Academy%20Awards">The Gender Gap at the Academy Awards</a></li>
<li><a href="http://tarantino.silk.co/">Tarantino’s Filmography Visualized</a></li>
<li><a href="http://bechdel-test.silk.co/">Data Analysis of 6,000 Movies and Their Bechdel Test Scores. From Pauvre Pierrot (1892) to Jurassic World (2015)</a></li>
<li><a href="http://film-festivals.silk.co/">Women at the International Film Festivals of 2015 - 2016</a></li></ul>   
<br />
<br />
<em>Originally published on <a href="http://blog.silk.co/post/127234807482/from-ombd-to-gender-data-on-film-directors-how-to">Silk's blog</a></em>.
</image></image></image></image></image></image></image></image></image></image></image></image></image></image></image></image></image>
</div>
</article>
</div>
</div>
<!-- Footer -->
<div class="clear"></div>
<footer id="footer">
	<div class="inner">
		<section>
			<h2>Get in touch</h2>
			<form method="post" action="https://formspree.io/8.a.c.huxl@gmail.com"
      method="POST">
				<div class="field half first">
					<input type="text" name="name" id="name" placeholder="Name" />
				</div>
				<div class="field half">
					<input type="email" name="_replyto" id="email" placeholder="Email" />
				</div>
				<div class="field">
					<textarea name="message" id="message" placeholder="Message"></textarea>
				</div>
				<ul class="actions">
					<li>
						<input type="submit" value="Send" class="special" />
					</li>
				</ul>
			</form>
		</section>
		<section>
			<h2>Follow</h2>
			<ul class="icons">
				
				<li><a href="https://twitter.com/alice_corona" class="icon style2 fa-twitter"><span class="label">Twitter</span></a></li>
				
				
				<li><a href="https://medium.com/@alice_corona" class="icon style2 fa-medium"><span class="label">Medium</span></a></li>
				
				
				
				
				
				<li><a href="https://github.com/ali-ce" class="icon style2 fa-github"><span class="label">GitHub</span></a></li>
				
				
				
				
				<li><a href="mailto:8.a.c.huxl@gmail.com" class="icon style2 fa-envelope-o"><span class="label">Email</span></a></li>
				
			</ul>
		</section>
		<ul class="copyright">
			<li><a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></li>
			<li>Powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://www.github.com">Github</a></li>
			<li>Design: Personal adaptation of the <a href="https://html5up.net/phantom">Phantom theme by HTML5 UP</a></li>
			<li>Jekyll integration: <a href="http://andrewbanchi.ch">Andrew Banchich</a></li>
		</ul>
	</div>
</footer>

</div>

<!-- Scripts -->
<script src="http://localhost:4000/assets/js/jquery.min.js"></script>
<script src="http://localhost:4000/assets/js/skel.min.js"></script>
<script src="http://localhost:4000/assets/js/util.js"></script>
<!--[if lte IE 8]><script src="http://localhost:4000/assets/js/ie/respond.min.js"></script><![endif]-->
<script src="http://localhost:4000/assets/js/main.js"></script>
 
</body>
</html>